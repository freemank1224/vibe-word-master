# 单词测试系统重构与增强计划 (Vibe-Word Test Mode V2)

本计划旨在将现有的基础测试模式重构为一个深度融合学习科学、标准发音以及智能反馈的专业单词背诵系统。

## 1. 核心交互设计：递进式提示系统 (Progressive Hints)

放弃传统的并列显示，采用**递进式（Progressive）**逻辑，以最大限度触发大脑的主动回忆（Active Recall）。

### 难度与提示等级映射
- **Hard (地狱模式)**：初始仅播放语音 (Level 0)。
- **Medium (练习模式)**：初始播放语音 + 显示模糊提示图 (Level 1)。
- **Easy (入门模式)**：初始显示语音 + 模糊图 + 中文/英文释义 (Level 2)。

### 交互特色
- **手动求助**：在输入框旁增加 `Hint` 按钮，每点击一次解锁下一级提示，但会相应增加该词的得分惩罚。
- **揭示答案 (Reveal)**：设计显著的“公布答案”按钮。点击后：
    1. 立即显示正确拼写、清晰图片、音标及释义。
    2. 自动标记该词为“错误”。
    3. `error_count` 自动累加。

## 2. 数据源与音频升级：标准音集成

摒弃单一的系统合成音，集成高质量在线词典服务。

### 外部 API 集成
- **Dictionary API**: `https://api.dictionaryapi.dev/api/v2/entries/en/{word}`
    - **标准读音**：获取真人发音的 `.mp3` 链接，作为测试时的首选音源。
    - **音标 (IPA)**：提取标准音标（如 `/ɪkˈsplɔː/`）展示在界面。
    - **英文释义**：提取核心义项作为备选提示。
- **翻译服务**：利用辅助 API（如 MyMemory 或后端 LLM）补全中文释义（`definition_cn`）。

### 处理策略
- **异步补全**：在“添加单词”保存后的后台阶段，程序将自动轮询新入库单词，通过 API 补全音标、音频 URL 和释义，避免在测试时产生网络延迟。

## 3. 智能复习算法：易错词动态平衡 (Vibe-SRS)

引入基于用户表现的抽检机制，将测试模式从“随机抽考”进化为“针对性训练”。

### 数据维度扩展
- `error_count`: 单词错误计数（权重）。
- `best_time_ms`: 该词拼写的最快正确记录（毫秒级计时）。
- `last_tested`: 最后一次测试的时间戳。

### 加权抽检算法
在生成测试队列时，不再使用单纯的随机洗牌，而是：
1. **基础池**：当前文件夹/Session 选中的词（占 70%）。
2. **易错回扣**：基于 `error_count` 和 `last_tested` 计算权值，从全库中抽取的易错词（占 30%）。
3. **优先级**：错误权重越高、距离上次测试越久的词，出现在队列前部的概率越大。

## 4. 计时系统与对战准备

为后续“在线对战模式”奠定数据基础。
- **瞬时计时**：从单词加载到用户正确输入的时间差。
- **性能统计**：测试结束后的结算页面，展示平均响应速度、正确率趋势图。
## 5. 页面布局与视觉重构 (Layout & UI Design)

为了提升专业感和对长单词的适应性，测试页面将进行彻底的响应式重构。

### 核心布局原则 (De-integrated Components)
- **解构框架**：拆除统一的 `light-charcoal` 背景固定宽度外框。将“提示区” (Hint Zone) 与“输入区” (Input Zone) 在视觉上进行物理分离，确保各部分能够独立响应不同的屏幕宽度。
- **全屏输入视野**：输入区域不再受限于卡片宽度。使用横跨屏幕的底部或中央区域，确保长单词在录入时具有完整的可见性和震撼的视觉效果。
- **极简主义英文化**：除可选的中文翻译外，界面中所有按钮、标签、提示文字均**严禁使用中文**。使用通俗易懂的英文术语（如 "Check", "Reveal Answer", "Next Word", "Time Average" 等）。

### 控件分布规划
- **顶部进度条**：纤细的顶通进度条，实时展示进度及当前用时。
- **中央提示区 (The Stage)**：
    - 动态模糊图片（根据 Hint Level 自动切换）。
    - 音标 (IPA) 及词性标识（拼写错误或解锁后显示）。
    - 独立的点击播放按钮。
- **下方输入控制区 (The Action)**：
    - **LargeWordInput**：居中，大字符，支持自适应无限宽度。
    - **Reveal Button**：位于侧边或下方，醒目但不干扰正常输入。
    - **Status Indicators**：计时跳动与当前连对次数的小挂件。

## 6. 开发路线图 (Roadmap)

1. **Phase 1 (Data)**: 修改数据库 Schema 及 Types 定义，扩展 `WordEntry` 及 `dataService` 接口。
2. **Phase 2 (Service)**: 实现 `dictionaryService` 用以请求外部标准音频和音标。
3. **Phase 3 (UI)**: 重构 `TestMode.tsx` 组件，实现递进提示、计时器及“揭示答案”功能。
4. **Phase 4 (Algorithm)**: 实现加权洗牌队列逻辑。
5. **Phase 5 (Flow)**: 优化 `App.tsx` 的保存逻辑，增加后台数据补全流。
