<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edge Function æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
      color: #fff;
    }
    .container {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 32px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    h1 {
      color: #10b981;
      margin-bottom: 8px;
    }
    .subtitle {
      color: #9ca3af;
      margin-bottom: 24px;
    }
    .test-section {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .status {
      padding: 8px 16px;
      border-radius: 8px;
      margin: 12px 0;
      font-size: 14px;
    }
    .status.success {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
      border: 1px solid rgba(16, 185, 129, 0.3);
    }
    .status.error {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.3);
    }
    .status.info {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }
    button {
      padding: 12px 24px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: #fff;
      transition: all 0.2s;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }
    code {
      background: rgba(0, 0, 0, 0.3);
      padding: 4px 8px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 12px;
    }
    .url-display {
      background: rgba(0, 0, 0, 0.3);
      padding: 12px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 12px;
      word-break: break-all;
      margin: 12px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>âœ… Supabase Edge Function éƒ¨ç½²æˆåŠŸ</h1>
    <p class="subtitle">å‘éŸ³ä»£ç†æœåŠ¡å·²è‡ªåŠ¨éƒ¨ç½²å¹¶æµ‹è¯•é€šè¿‡</p>

    <div class="test-section">
      <h3>ğŸ“‹ éƒ¨ç½²ä¿¡æ¯</h3>
      <div class="status success">âœ… Edge Function å·²æ¿€æ´»</div>
      <div class="status success">âœ… è¯­éŸ³ä»£ç†æµ‹è¯•é€šè¿‡</div>
      <div class="status success">âœ… ç¯å¢ƒå˜é‡å·²é…ç½®</div>

      <p style="margin-top: 16px;"><strong>Edge Function URL:</strong></p>
      <div class="url-display">
        https://mkdxdlsjisqazermmfoe.supabase.co/functions/v1/pronunciation
      </div>

      <p style="margin-top: 12px;"><strong>æµ‹è¯•ç¤ºä¾‹:</strong></p>
      <div class="url-display">
        ?word=hello&source=youdao&lang=en
      </div>
    </div>

    <div class="test-section">
      <h3>ğŸ”Š å¿«é€Ÿæµ‹è¯•</h3>
      <button onclick="testPronunciation()">æµ‹è¯• "hello" å‘éŸ³</button>
      <div id="status" class="status info" style="display: none;"></div>
    </div>

    <div class="test-section">
      <h3>ğŸ“š ä¸‹ä¸€æ­¥</h3>
      <p style="line-height: 1.6; color: #d1d5db;">
        âœ… æ‰€æœ‰é…ç½®å·²å®Œæˆï¼<br>
        âœ… æœ¬åœ°å¼€å‘ç¯å¢ƒå·²å°±ç»ª<br>
        âœ… Vercel éƒ¨ç½²åå°†è‡ªåŠ¨ä½¿ç”¨ä»£ç†æœåŠ¡
      </p>
      <div class="status info" style="margin-top: 12px;">
        ğŸ’¡ <strong>æç¤º</strong>: ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨å•è¯å‘éŸ³åŠŸèƒ½äº†
      </div>
    </div>
  </div>

  <script>
    async function testPronunciation() {
      const status = document.getElementById('status');
      status.style.display = 'block';
      status.textContent = 'â³ æ­£åœ¨æµ‹è¯•å‘éŸ³...';
      status.className = 'status info';

      try {
        const response = await fetch(
          'https://mkdxdlsjisqazermmfoe.supabase.co/functions/v1/pronunciation?word=hello&source=youdao&lang=en'
        );

        if (response.ok) {
          const audioBlob = await response.blob();
          const audioUrl = URL.createObjectURL(audioBlob);
          const audio = new Audio(audioUrl);
          audio.play();

          status.textContent = 'âœ… æ’­æ”¾æˆåŠŸï¼Edge Function å·¥ä½œæ­£å¸¸';
          status.className = 'status success';

          setTimeout(() => URL.revokeObjectURL(audioUrl), 5000);
        } else {
          throw new Error(`HTTP ${response.status}`);
        }
      } catch (error) {
        status.textContent = `âŒ é”™è¯¯: ${error.message}`;
        status.className = 'status error';
      }
    }
  </script>
</body>
</html>
